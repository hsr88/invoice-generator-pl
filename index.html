<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generator Faktur VAT</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="grain"></div>
    
    <div class="container">
        <header class="header">
            <div class="header-content">
                <h1 class="title">GENERATOR<br>FAKTUR</h1>
                <div class="header-badge">PL</div>
            </div>
            <p class="subtitle">Profesjonalne faktury VAT w 60 sekund</p>
        </header>

        <div class="form-wrapper">
            <!-- Panel Auto-numeracji i Bazy Klientów -->
            <div class="quick-actions">
                <div class="quick-action-card">
                    <h3>
                        <svg class="title-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="16" y1="2" x2="16" y2="6"></line>
                            <line x1="8" y1="2" x2="8" y2="6"></line>
                            <line x1="3" y1="10" x2="21" y2="10"></line>
                        </svg>
                        Auto-numeracja
                    </h3>
                    <button type="button" class="btn-quick" onclick="useNextInvoiceNumber()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="12" y1="8" x2="12" y2="16"></line>
                            <line x1="8" y1="12" x2="16" y2="12"></line>
                        </svg>
                        Użyj kolejnego numeru
                    </button>
                    <p class="quick-hint">Następny: <span id="nextInvoiceNumber">FV/001/2024</span></p>
                </div>
                <div class="quick-action-card">
                    <h3>
                        <svg class="title-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="9" cy="7" r="4"></circle>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                        </svg>
                        Baza klientów
                    </h3>
                    <button type="button" class="btn-quick" onclick="openClientDatabase()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="9" cy="7" r="4"></circle>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                        </svg>
                        Zarządzaj klientami
                    </button>
                    <div class="client-selector">
                        <select id="clientSelect" onchange="loadClientData()">
                            <option value="">Wybierz klienta...</option>
                        </select>
                    </div>
                </div>
                <div class="quick-action-card auto-save-indicator">
                    <h3>
                        <svg class="title-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                            <polyline points="17 21 17 13 7 13 7 21"></polyline>
                            <polyline points="7 3 7 8 15 8"></polyline>
                        </svg>
                        Auto-zapis
                    </h3>
                    <div class="auto-save-status">
                        <div class="status-dot" id="autoSaveDot"></div>
                        <span id="autoSaveStatus">Gotowy</span>
                    </div>
                    <p class="quick-hint">Ostatni zapis: <span id="lastSaveTime">-</span></p>
                </div>
            </div>

            <!-- Dane Sprzedawcy -->
            <section class="section">
                <div class="section-header">
                    <div class="section-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                            <circle cx="12" cy="7" r="4"></circle>
                        </svg>
                    </div>
                    <h2>Dane Sprzedawcy</h2>
                </div>
                <div class="form-grid">
                    <div class="input-group">
                        <label>Nazwa Firmy *</label>
                        <input type="text" id="fromCompany" placeholder="np. ACME Sp. z o.o." required>
                    </div>
                    <div class="input-group">
                        <label>NIP *</label>
                        <input type="text" id="fromNIP" placeholder="123-456-78-90" required>
                    </div>
                    <div class="input-group">
                        <label>Ulica i numer</label>
                        <input type="text" id="fromAddress" placeholder="ul. Przykładowa 123">
                    </div>
                    <div class="input-group">
                        <label>Kod pocztowy</label>
                        <input type="text" id="fromZip" placeholder="00-000">
                    </div>
                    <div class="input-group">
                        <label>Miasto</label>
                        <input type="text" id="fromCity" placeholder="Warszawa">
                    </div>
                    <div class="input-group">
                        <label>Email</label>
                        <input type="email" id="fromEmail" placeholder="firma@example.pl">
                    </div>
                    <div class="input-group">
                        <label>Telefon</label>
                        <input type="tel" id="fromPhone" placeholder="+48 123 456 789">
                    </div>
                    <div class="input-group">
                        <label>Numer konta bankowego</label>
                        <input type="text" id="fromBank" placeholder="12 3456 7890 1234 5678 9012 3456">
                    </div>
                </div>
            </section>

            <!-- Dane Nabywcy -->
            <section class="section">
                <div class="section-header">
                    <div class="section-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="8.5" cy="7" r="4"></circle>
                            <line x1="20" y1="8" x2="20" y2="14"></line>
                            <line x1="23" y1="11" x2="17" y2="11"></line>
                        </svg>
                    </div>
                    <h2>Dane Nabywcy</h2>
                </div>
                <div class="form-grid">
                    <div class="input-group">
                        <label>Nazwa Firmy / Imię i Nazwisko *</label>
                        <input type="text" id="toCompany" placeholder="np. Klient Sp. z o.o." required>
                    </div>
                    <div class="input-group">
                        <label>NIP</label>
                        <input type="text" id="toNIP" placeholder="987-654-32-10">
                    </div>
                    <div class="input-group">
                        <label>Ulica i numer</label>
                        <input type="text" id="toAddress" placeholder="ul. Kliencka 456">
                    </div>
                    <div class="input-group">
                        <label>Kod pocztowy</label>
                        <input type="text" id="toZip" placeholder="00-000">
                    </div>
                    <div class="input-group">
                        <label>Miasto</label>
                        <input type="text" id="toCity" placeholder="Kraków">
                    </div>
                    <div class="input-group">
                        <label>Email</label>
                        <input type="email" id="toEmail" placeholder="klient@example.pl">
                    </div>
                </div>
            </section>

            <!-- Dane Faktury -->
            <section class="section">
                <div class="section-header">
                    <div class="section-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                            <polyline points="14 2 14 8 20 8"></polyline>
                            <line x1="16" y1="13" x2="8" y2="13"></line>
                            <line x1="16" y1="17" x2="8" y2="17"></line>
                            <polyline points="10 9 9 9 8 9"></polyline>
                        </svg>
                    </div>
                    <h2>Dane Faktury</h2>
                </div>
                <div class="form-grid">
                    <div class="input-group">
                        <label>Numer Faktury *</label>
                        <input type="text" id="invoiceNumber" placeholder="FV/01/2024" required>
                    </div>
                    <div class="input-group">
                        <label>Data Wystawienia *</label>
                        <input type="date" id="invoiceDate" required>
                    </div>
                    <div class="input-group">
                        <label>Data Sprzedaży</label>
                        <input type="date" id="saleDate">
                    </div>
                    <div class="input-group">
                        <label>Termin Płatności</label>
                        <input type="date" id="dueDate">
                    </div>
                    <div class="input-group">
                        <label>Metoda Płatności</label>
                        <select id="paymentMethod">
                            <option value="Przelew">Przelew</option>
                            <option value="Gotówka">Gotówka</option>
                            <option value="Karta">Karta płatnicza</option>
                            <option value="BLIK">BLIK</option>
                        </select>
                    </div>
                </div>
            </section>

            <!-- Pozycje -->
            <section class="section">
                <div class="section-header">
                    <div class="section-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="8" y1="6" x2="21" y2="6"></line>
                            <line x1="8" y1="12" x2="21" y2="12"></line>
                            <line x1="8" y1="18" x2="21" y2="18"></line>
                            <line x1="3" y1="6" x2="3.01" y2="6"></line>
                            <line x1="3" y1="12" x2="3.01" y2="12"></line>
                            <line x1="3" y1="18" x2="3.01" y2="18"></line>
                        </svg>
                    </div>
                    <h2>Pozycje Faktury</h2>
                </div>
                <div class="items-wrapper" id="itemsContainer">
                    <div class="item-card">
                        <div class="item-header">
                            <span class="item-number">1</span>
                            <button type="button" class="item-remove" onclick="removeItem(this)">×</button>
                        </div>
                        <div class="item-grid">
                            <div class="input-group span-full">
                                <label>Nazwa Towaru / Usługi *</label>
                                <input type="text" class="item-name" placeholder="np. Usługi programistyczne">
                            </div>
                            <div class="input-group">
                                <label>J.M.</label>
                                <select class="item-unit">
                                    <option value="szt.">szt.</option>
                                    <option value="godz.">godz.</option>
                                    <option value="usł.">usł.</option>
                                    <option value="m">m</option>
                                    <option value="m²">m²</option>
                                    <option value="kg">kg</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label>Ilość</label>
                                <input type="number" class="item-quantity" value="1" min="0" step="0.01">
                            </div>
                            <div class="input-group">
                                <label>Cena Netto (PLN)</label>
                                <input type="number" class="item-price" value="0" min="0" step="0.01">
                            </div>
                            <div class="input-group">
                                <label>VAT (%)</label>
                                <select class="item-vat">
                                    <option value="23">23%</option>
                                    <option value="8">8%</option>
                                    <option value="5">5%</option>
                                    <option value="0">0%</option>
                                    <option value="zw">zw.</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label>Wartość Netto</label>
                                <input type="text" class="item-netto" readonly>
                            </div>
                            <div class="input-group">
                                <label>Kwota VAT</label>
                                <input type="text" class="item-vat-amount" readonly>
                            </div>
                            <div class="input-group">
                                <label>Wartość Brutto</label>
                                <input type="text" class="item-brutto" readonly>
                            </div>
                        </div>
                    </div>
                </div>
                <button type="button" class="btn-add-item" onclick="addItem()">
                    <span>+</span> Dodaj Pozycję
                </button>
            </section>

            <!-- Podsumowanie -->
            <section class="summary-section">
                <div class="summary-card">
                    <h3>Podsumowanie</h3>
                    <div class="summary-grid">
                        <div class="summary-row">
                            <span>Suma Netto:</span>
                            <strong id="totalNetto">0,00 PLN</strong>
                        </div>
                        <div class="summary-row">
                            <span>Suma VAT:</span>
                            <strong id="totalVAT">0,00 PLN</strong>
                        </div>
                        <div class="summary-row total-row">
                            <span>Do Zapłaty:</span>
                            <strong id="totalBrutto">0,00 PLN</strong>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Uwagi -->
            <section class="section">
                <div class="section-header">
                    <div class="section-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                        </svg>
                    </div>
                    <h2>Dodatkowe Informacje</h2>
                </div>
                <div class="input-group">
                    <label>Uwagi</label>
                    <textarea id="notes" rows="3" placeholder="np. Termin płatności: 7 dni od daty wystawienia"></textarea>
                </div>
            </section>

            <!-- Przyciski Akcji -->
            <div class="actions-grid">
                <button type="button" class="btn btn-primary" onclick="generatePDF()">
                    <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                        <line x1="12" y1="18" x2="12" y2="12"></line>
                        <line x1="9" y1="15" x2="15" y2="15"></line>
                    </svg>
                    <span>Generuj PDF</span>
                </button>
                <button type="button" class="btn btn-secondary" onclick="previewInvoice()">
                    <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                        <circle cx="12" cy="12" r="3"></circle>
                    </svg>
                    <span>Podgląd</span>
                </button>
                <button type="button" class="btn btn-secondary" onclick="saveTemplate()">
                    <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                        <polyline points="17 21 17 13 7 13 7 21"></polyline>
                        <polyline points="7 3 7 8 15 8"></polyline>
                    </svg>
                    <span>Zapisz Szablon</span>
                </button>
                <button type="button" class="btn btn-secondary" onclick="loadTemplate()">
                    <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path>
                        <polyline points="13 2 13 9 20 9"></polyline>
                    </svg>
                    <span>Wczytaj Szablon</span>
                </button>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-content">
                <p class="footer-text">Made with ❤️ by</p>
                <a href="https://github.com/hsr88" target="_blank" rel="noopener noreferrer" class="github-link">
                    <svg class="github-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                    </svg>
                    <span>hsr88</span>
                </a>
            </div>
            <div class="footer-links">
                <a href="https://github.com/hsr88/invoice-generator-pl" target="_blank" rel="noopener noreferrer" class="footer-link">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle>
                        <line x1="12" y1="16" x2="12" y2="12"></line>
                        <line x1="12" y1="8" x2="12.01" y2="8"></line>
                    </svg>
                    O projekcie
                </a>
                <a href="https://github.com/hsr88/invoice-generator-pl/issues" target="_blank" rel="noopener noreferrer" class="footer-link">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                    </svg>
                    Zgłoś błąd
                </a>
            </div>
        </footer>
    </div>

    <!-- Modal Podglądu -->
    <div id="previewModal" class="modal">
        <div class="modal-backdrop" onclick="closePreview()"></div>
        <div class="modal-content">
            <button class="modal-close" onclick="closePreview()">×</button>
            <div id="previewContainer"></div>
        </div>
    </div>

    <!-- Modal Bazy Klientów -->
    <div id="clientDatabaseModal" class="modal">
        <div class="modal-backdrop" onclick="closeClientDatabase()"></div>
        <div class="modal-content client-db-modal">
            <button class="modal-close" onclick="closeClientDatabase()">×</button>
            <div class="client-db-container">
                <h2>Baza Klientów</h2>
                
                <div class="client-db-actions">
                    <button class="btn btn-primary" onclick="showAddClientForm()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="8.5" cy="7" r="4"></circle>
                            <line x1="20" y1="8" x2="20" y2="14"></line>
                            <line x1="23" y1="11" x2="17" y2="11"></line>
                        </svg>
                        Dodaj Klienta
                    </button>
                </div>

                <div id="addClientForm" class="add-client-form" style="display: none;">
                    <h3>Nowy Klient</h3>
                    <div class="form-grid">
                        <div class="input-group">
                            <label>Nazwa *</label>
                            <input type="text" id="newClientName" placeholder="Nazwa firmy">
                        </div>
                        <div class="input-group">
                            <label>NIP</label>
                            <input type="text" id="newClientNIP" placeholder="XXX-XXX-XX-XX">
                        </div>
                        <div class="input-group">
                            <label>Ulica</label>
                            <input type="text" id="newClientAddress">
                        </div>
                        <div class="input-group">
                            <label>Kod</label>
                            <input type="text" id="newClientZip" placeholder="00-000">
                        </div>
                        <div class="input-group">
                            <label>Miasto</label>
                            <input type="text" id="newClientCity">
                        </div>
                        <div class="input-group">
                            <label>Email</label>
                            <input type="email" id="newClientEmail">
                        </div>
                    </div>
                    <div class="form-actions">
                        <button class="btn btn-primary" onclick="saveNewClient()">Zapisz</button>
                        <button class="btn btn-secondary" onclick="cancelAddClient()">Anuluj</button>
                    </div>
                </div>

                <div class="client-list" id="clientList"></div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="script.js"></script>
</body>
</html>